<!DOCTYPE html>
<html lang="en" dir="ltr" ng-app = "flights">
<head>
    <meta charset="utf-8">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.8/angular.min.js"></script>
    <script src="/js/app.js" charset="utf-8"></script>
    <link rel="stylesheet" href="/css/app.css">

    <title></title>
</head>
<body ng-controller = "MyController as ctrl">

    <section ng-if = "ctrl.loggedInUser === false">
        <h3>Sign Up:</h3>
        <form ng-submit = ctrl.signup()>
            <label for="signupUsername">Username:</label>
            <input id="signupUsername" type="text" ng-model="ctrl.signupUsername">
            <label for="signupPassword">Password:</label>
            <input id="signupPassword" type="password" ng-model="ctrl.signupPassword">
            <input type="submit" value="Sign Up">
        </form>
        <h3>Login:</h3>
        <form ng-submit = "ctrl.login()">
            <label for="loginUsername">Username:</label>
            <input id="loginUsername" type="text" ng-model="ctrl.loginUsername">
            <label for="loginPassword">Password:</label>
            <input id="loginPassword" type="password" ng-model="ctrl.loginPassword">
            <input type="submit" value="Log In">
        </form>
    </section>

    <section ng-if = "ctrl.loggedInUser !== false">
        <h1>Save Your Flight</h1>
        <button ng-click = "ctrl.logout()">Log Out</button>
        <form ng-submit = "ctrl.createFlight()">
            <input type="text" ng-model = "ctrl.country" placeholder="Country"><br/>
            <input type="text" ng-model = "ctrl.currency" placeholder="Currency"><br/>
            <input type="text" ng-model = "ctrl.locale" placeholder="Locale"><br/>
            <input type="text" ng-model = "ctrl.originPlace" placeholder="Origin"><br/>
            <input type="text" ng-model = "ctrl.destinationPlace" placeholder="Destination"><br/>
            <input type="date" ng-model = "ctrl.outboundPartialDate" placeholder="Departure Date"><br/>
            <input type="date" ng-model = "ctrl.inboundPartialDate" placeholder="Return Date"><br/>
            <input type="submit" value="Save flight">
        </form>
<br/>
        <label for="Search By">
            <input type="text" placeholder = "Search My Flights" ng-model = 'searchBox'>
        </label>

        <div class="flightList">
            <div ng-repeat = "flight in ctrl.flights | filter: searchBox">
                <div class="flight">
                    Country: {{flight.country}}<br/>
                    Currency: {{flight.currency}}<br/>
                    Locale: {{flight.locale}}<br/>
                    Origin: {{flight.originPlace}}<br/>
                    Destination: {{flight.destinationPlace}}<br/>
                    Departure Date: {{flight.outboundPartialDate}}<br/>
                    Return Date: {{flight.inboundPartialDate}}<br/>
                    <button ng-click = "ctrl.deleteFlight(flight)">Delete flight</button>
                    <button ng-if = "$index !== ctrl.indexOfFormToShow" ng-click = "ctrl.indexOfFormToShow = $index;ctrl.updatedCountry = '';ctrl.updatedCurrency = '';ctrl.updatedLocale = '';ctrl.updatedOriginPlace = '';ctrl.updatedDestinationPlace = '';ctrl.updatedOutboundPartialDate = '';ctrl.updatedInboundPartialDate = ''">Edit Flight
                    </button>

                    <form ng-if = "$index === ctrl.indexOfFormToShow" ng-submit = "ctrl.editFlight(flight)">
                        <input type="text" ng-model = "ctrl.updatedCountry" placeholder = "Updated Country"><br/>
                        <input type="text" ng-model = "ctrl.updatedCurrency" placeholder = "Updated Currency"><br/>
                        <input type="text" ng-model = "ctrl.updatedLocale" placeholder = "Updated Locale"><br/>
                        <input type="text" ng-model = "ctrl.updatedOriginPlace" placeholder = "Updated Origin"><br/>
                        <input type="text" ng-model = "ctrl.updatedDestinationPlace" placeholder = "Updated Destination"><br/>
                        <input type="date" ng-model = "ctrl.updatedOutboundPartialDate" placeholder = "Updated Departure"><br/>
                        <input type="date" ng-model = "ctrl.updatedInboundPartialDate" placeholder = "Updated Return"><br/>
                        <input type="submit" value="Submit Edits">
                        <button ng-click = "ctrl.indexOfFormToShow = null">Cancel</button>
                    </form>
                </div>
            </div>
        </div>


    </section>

</body>
</html>
