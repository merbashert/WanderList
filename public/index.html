<!DOCTYPE html>
<html lang="en" dir="ltr" ng-app = "flights">
<head>
    <meta charset="utf-8">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.8/angular.min.js"></script>
    <script src="/js/app.js" charset="utf-8"></script>
    <title></title>
</head>
<body ng-controller = "MyController as ctrl">

    <section ng-if = "ctrl.loggedInUser === false">
        <h3>Sign Up:</h3>
        <form ng-submit = ctrl.signup()>
            <label for="signupUsername">Username:</label>
            <input id="signupUsername" type="text" ng-model="ctrl.signupUsername">
            <label for="signupPassword">Password:</label>
            <input id="signupPassword" type="password" ng-model="ctrl.signupPassword">
            <input type="submit" value="Sign Up">
        </form>
        <h3>Login:</h3>
        <form ng-submit = "ctrl.login()">
            <label for="loginUsername">Username:</label>
            <input id="loginUsername" type="text" ng-model="ctrl.loginUsername">
            <label for="loginPassword">Password:</label>
            <input id="loginPassword" type="password" ng-model="ctrl.loginPassword">
            <input type="submit" value="Log In">
        </form>
    </section>

<section ng-if = "ctrl.loggedInUser !== false">
    <h1>Create Your Dream Trip</h1>

    <h4>Already Know your flight details? Add them into the tracker below</h4>
    <form ng-submit = "ctrl.createFlight()">

        <button ng-click = "ctrl.logout()">Log Out</button>

        <input type="text" ng-model = "ctrl.country" placeholder="Country"><br/>
        <input type="text" ng-model = "ctrl.currency" placeholder="Currency"><br/>
        <input type="text" ng-model = "ctrl.locale" placeholder="Locale"><br/>
        <input type="text" ng-model = "ctrl.originPlace" placeholder="Origin"><br/>
        <input type="text" ng-model = "ctrl.destinationPlace" placeholder="Destination"><br/>
        <input type="date" ng-model = "ctrl.outboundPartialDate" placeholder="Departure Date"><br/>
        <input type="date" ng-model = "ctrl.inboundPartialDate" placeholder="Return Date"><br/>
        <input type="submit" value="Save Trip">
    </form>

    <div ng-repeat = "trip in ctrl.trips">
        Currency: {{trip.currency}}
        Locale: {{trip.locale}}
        Origin: {{trip.originPlace}}
        Destination: {{trip.destinationPlace}}
        Departure Date: {{trip.outboundPartialDate}}
        Return Date: {{trip.inboundPartialDate}}
        <button ng-click = "ctrl.deleteTrip(trip)">Delete Trip</button>
        <a ng-if = "$index !== ctrl.indexOfFormToShow" ng-click = "ctrl.indexOfFormToShow = $index;ctrl.updatedCountry = '';ctrl.updatedCurrency = '';ctrl.updatedLocale = '';ctrl.updatedOriginPlace = '';ctrl.updatedDestinationPlace = '';ctrl.updatedOutboundPartialDate = '';ctrl.updatedInboundPartialDate = ''">
        </a>

        <form ng-if = "$index === ctrl.indexOfFormToShow" ng-submit = "ctrl.editTrip(trip)">
            <input type="text" ng-model = "ctrl.updatedCountry" placeholder = "Updated Country"><br/>
            <input type="text" ng-model = "ctrl.updatedCurrency" placeholder = "Updated Currency"><br/>
            <input type="text" ng-model = "ctrl.updatedLocale" placeholder = "Updated Locale"><br/>
            <input type="text" ng-model = "ctrl.updatedOriginPlace" placeholder = "Updated Origin"><br/>
            <input type="text" ng-model = "ctrl.updatedDestinationPlace" placeholder = "Updated Destination"><br/>
            <input type="text" ng-model = "ctrl.updatedOutboundPartialDate" placeholder = "Updated Departure"><br/>
            <input type="text" ng-model = "ctrl.updatedInboundPartialDate" placeholder = "Updated Currency"><br/>
            <input type="submit" value="Submit Edits">
            <button ng-click = "ctrl.indexOfFormToShow = null">Cancel</button>
        </form>

    </section>
    <h4> Don't know your flight details yet? Search new flights below and add the details into the tracker</h4>
    <style>
        #flightSearch {position: fixed; width: 100%; }
    </style>
    <!-- code to get flight to open on same page: data-target="_self" -->
    <div id:"flightSearch" data-skyscanner-widget="FlightSearchWidget" data-locale="en-GB" data-target="_self"></div>
    <script src="https://widgets.skyscanner.net/widget-server/js/loader.js" async></script>
    </div>


</body>
</html>
